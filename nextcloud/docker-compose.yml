version: '3'

services:
  nextcloud:
    image: nextcloud:latest
    volumes:
      - nextcloud:/var/www/html # Pulls from /var/lib/docker/volumes/nextcloud_nextcloud/_data/
      #- ./nextcloud/config:/var/www/html/config # Pulls from local dir
      #- /mnt/someHDD/nextcloud:/mnt/hdd # Pulls from root
    
    networks:
      - traefik-public
    labels:
      - traefik.backend=nextcloud
      - traefik.tags=traefik-public
      - traefik.docker.network=traefik-public
      - traefik.enable=true
      - traefik.frontend.rule=Host:cloud.unitygm.net
      - traefik.port=80
      # Traefik service that listens to HTTP
      - traefik.redirectorservice.frontend.entryPoints=http
      - traefik.redirectorservice.frontend.redirect.entryPoint=https
      # Traefik service that listens to HTTPS
      - traefik.webservice.frontend.entryPoints=https

 
networks:
  traefik-public:
    external: true

volumes:
  nextcloud:
